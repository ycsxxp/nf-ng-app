<div>
  <div nz-row class="condition_collapse">
    <nz-collapseset>
      <nz-collapse [nzTitle]="panel.name" [nzActive]="panel.active" [nzDisabled]="panel.disabled">
        <form nz-form [nzLayout]='inline'>
          <div nz-form-item nz-row>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>时间范围</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="14">
              <nz-demo-datepicker-start-end></nz-demo-datepicker-start-end>
            </div>
          </div>
          <div nz-form-item nz-row>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>动作</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-select style="width: 120px;" name="action" [nzSize]="'small'" [(ngModel)]="selectedAction" nzAllowClear>
                <nz-option
                  *ngFor="let option of actions"
                  [nzLabel]="option.label"
                  [nzValue]="option">
                </nz-option>
              </nz-select>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>模块</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-select style="width: 120px;" name="module" [nzSize]="'small'" [(ngModel)]="selectedModule" nzAllowClear>
                <nz-option
                  *ngFor="let option of modules"
                  [nzLabel]="option.label"
                  [nzValue]="option">
                </nz-option>
              </nz-select>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>风险等级</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-select style="width: 120px;" name="input_risk" [nzSize]="'small'" [(ngModel)]="selectedInputRisk" [nzMode]="'multiple'" [nzPlaceHolder]="'请选择风险等级'">
                <nz-option
                  *ngFor="let option of input_risks"
                  [nzLabel]="option.label"
                  [nzValue]="option">
                </nz-option>
              </nz-select>
            </div>
          </div>
          <div nz-form-item nz-row>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>安全策略编号</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="rule_id" [nzSize]="'small'" [(ngModel)]="rule_id" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>协议</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="protocol" [nzSize]="'small'" [(ngModel)]="protocol" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>描述</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="comment" [nzSize]="'small'" [(ngModel)]="comment" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
          </div>
          <div nz-form-item nz-row>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>源接口</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="src_card" [nzSize]="'small'" [(ngModel)]="src_card" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>源地址</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="src_ip" [nzSize]="'small'" [(ngModel)]="src_ip" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>源端口</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="src_port" [nzSize]="'small'" [(ngModel)]="src_port" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
          </div>
          <div nz-form-item nz-row>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>目的接口</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="dst_card" [nzSize]="'small'" [(ngModel)]="dst_card" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>目的地址</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="dst_ip" [nzSize]="'small'" [(ngModel)]="dst_ip" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>目的端口</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="dst_port" [nzSize]="'small'" [(ngModel)]="dst_port" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
          </div>
          <div nz-form-item nz-row>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>源地址（NAT后）</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="nat_src_ip" [nzSize]="'small'" [(ngModel)]="nat_src_ip" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>源端口（NAT后）</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="nat_src_port" [nzSize]="'small'" [(ngModel)]="nat_src_port" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>用户</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="user" [nzSize]="'small'" [(ngModel)]="user" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
          </div>
          <div nz-form-item nz-row>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>目的地址（NAT后）</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="nat_dst_ip" [nzSize]="'small'" [(ngModel)]="nat_dst_ip" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>目的端口（NAT后）</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="nat_dst_port" [nzSize]="'small'" [(ngModel)]="nat_dst_port" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>应用名称</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="5">
              <nz-input style="width: 120px;" name="app_name" [nzSize]="'small'" [(ngModel)]="app_name" [nzPlaceHolder]="'请输入'" ></nz-input>
            </div>
          </div>
          <div nz-form-item nz-row>
            <div nz-form-label nz-col [nzSpan]="3">
              <label>类别</label>
            </div>
            <div nz-form-control nz-col [nzSpan]="6">
              <nz-cascader name="category"
                [nzOptions]="categories"
                [(ngModel)]="category">
              </nz-cascader>
            </div>
          </div>
          <div nz-form-item nz-row>
            <div nz-form-control nz-col [nzSpan]="21" [nzOffset]="3">
              <button nz-button [nzType]="'primary'" [nzSize]="'large'">查询</button>
            </div>
          </div>
        </form>
      </nz-collapse>
    </nz-collapseset>
  </div>
  <div nz-row [nzType]="'flex'" [nzAlign]="'middle'" style="margin-bottom: 5px;">
    <div nz-col [nzSpan]="14">
      <nz-pagination [(nzPageIndex)]="_current" [nzTotal]="50" [nzSize]="'small'" nzShowSizeChanger nzShowQuickJumper></nz-pagination>
    </div>
    <div nz-col [nzSpan]="8" style="text-align: right;padding-right: 10px;">
      <nz-button-group>
        <button nz-button [nzType]="'primary'">
          <i class="anticon anticon-download"></i>
        </button>
        <button nz-button [nzType]="'primary'">
          <i class="anticon anticon-printer"></i>
        </button>
      </nz-button-group>
    </div>
    <div nz-col [nzSpan]="2" style="text-align: right;">
      <button nz-button [nzType]="'primary'"><span>清空数据</span></button>
    </div>
  </div>
  <div nz-row>
    <nz-table #nzTable [nzDataSource]="_dataSet" [nzBordered]="true" [nzIsPagination]="false">
    <thead nz-thead>
      <tr>
        <th nz-th><span>时间</span></th>
        <th nz-th><span>应用名称</span></th>
        <th nz-th><span>策略号</span></th>
        <th nz-th><span>模块</span></th>
        <th nz-th><span>源</span></th>
        <th nz-th><span>用户</span></th>
        <th nz-th><span>目的</span></th>
        <th nz-th><span>源（NAT）</span></th>
        <th nz-th><span>目的（NAT）</span></th>
        <th nz-th><span>协议</span></th>
        <th nz-th><span>源接口</span></th>
        <th nz-th><span>目的接口</span></th>
        <th nz-th><span>会话标记</span></th>
        <th nz-th><span>描述</span></th>
      </tr>
    </thead>
    <tbody nz-tbody>
      <tr nz-tbody-tr *ngFor="let data of nzTable.data">
        <td nz-td>{{data.time}}</td>
        <td nz-td><a>{{data.app_name}}</a></td>
        <td nz-td>{{data.rule_id}}</td>
        <td nz-td>{{data.module}}</td>
        <td nz-td>{{data.src}}</td>
        <td nz-td>{{data.user}}</td>
        <td nz-td>{{data.dst}}</td>
        <td nz-td>{{data.nat_src}}</td>
        <td nz-td>{{data.nat_dst}}</td>
        <td nz-td>{{data.protocol}}</td>
        <td nz-td>{{data.src_card}}</td>
        <td nz-td>{{data.dst_card}}</td>
        <td nz-td>{{data.session}}</td>
        <td nz-td>{{data.desc}}</td>
      </tr>
    </tbody>
    </nz-table>
  </div>
  <div nz-row [nzType]="'flex'" [nzAlign]="'middle'" style="margin-top: 5px;">
    <nz-pagination [(nzPageIndex)]="_current" [nzTotal]="50" [nzSize]="'small'" nzShowSizeChanger nzShowQuickJumper></nz-pagination>
  </div>
</div>