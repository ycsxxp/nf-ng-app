<div>
  <form nz-form>
    <nz-collapseset [nzBordered]="false">
      <nz-collapse [nzTitle]="'高级威胁防护'" [nzActive]="true" [ngStyle]="{'border-radius': '4px','border': '0px'}">
        <div nz-form-item nz-row class="ant-form-item-last">
          <div nz-form-control nz-col [nzSpan]="3" [nzOffset]="1">
            <nz-switch name="enabled" [(ngModel)]="enabled">
              <span checked>启用</span>
              <span unchecked>停用</span>
            </nz-switch>
          </div>
        </div>
      </nz-collapse>
      <nz-collapse *ngIf="enabled" [nzTitle]="'威胁分析系统(TAC)'" [nzActive]="true" [ngStyle]="{'border-radius': '4px','border': '0px'}">
        <div nz-form-item nz-row>
          <div nz-form-label nz-col [nzSpan]="2">
            <label>服务器地址</label>
          </div>
          <div nz-form-control nz-col [nzSpan]="22">
            <nz-input style="width: 220px;" name="src_ip" [nzSize]="'default'" [(ngModel)]="ip" [nzPlaceHolder]="'请输入'" ></nz-input>
            <nz-tooltip [nzTitle]="'TAC的服务器地址'" [nzPlacement]="'right'" [nzTrigger]="'hover'">
              <button nz-button nz-tooltip [nzType]="'primary'" [nzSize]="'default'" [nzShape]="'circle'">
                <i class="anticon anticon-question"></i>
              </button>
            </nz-tooltip>
          </div>
        </div>
        <div nz-form-item nz-row>
          <div nz-form-label nz-col [nzSpan]="2">
            <label>用户名</label>
          </div>
          <div nz-form-control nz-col [nzSpan]="22">
            <nz-input style="width: 220px;" name="src_ip" [nzSize]="'default'" [(ngModel)]="ip" [nzPlaceHolder]="'请输入'" ></nz-input>
            <nz-tooltip [nzTitle]="'用户帐号须与TAC的API接口账号一致'" [nzPlacement]="'right'" [nzTrigger]="'hover'">
              <button nz-button nz-tooltip [nzType]="'primary'" [nzSize]="'default'" [nzShape]="'circle'">
                <i class="anticon anticon-question"></i>
              </button>
            </nz-tooltip>
          </div>
        </div>
        <div nz-form-item nz-row class="ant-form-item-last">
          <div nz-form-label nz-col [nzSpan]="2">
            <label>密码</label>
          </div>
          <div nz-form-control nz-col [nzSpan]="22">
            <nz-input style="width: 220px;" name="src_ip" [nzSize]="'default'" [(ngModel)]="ip" [nzPlaceHolder]="'请输入'" ></nz-input>
            <nz-tooltip [nzTitle]="'用户密码须与TAC的API接口密码一致'" [nzPlacement]="'right'" [nzTrigger]="'hover'">
              <button nz-button nz-tooltip [nzType]="'primary'" [nzSize]="'default'" [nzShape]="'circle'">
                <i class="anticon anticon-question"></i>
              </button>
            </nz-tooltip>
          </div>
        </div>
      </nz-collapse>
      <nz-collapse *ngIf="enabled" [nzTitle]="'检测对象配置'" [nzActive]="true" [ngStyle]="{'border-radius': '4px','border': '0px'}">
        <div nz-form-item nz-row>
          <div nz-form-label nz-col [nzSpan]="2">
            <label>应用</label>
          </div>
          <div nz-form-control nz-col [nzSpan]="22">
            <nz-checkbox-group name="protocol" [(ngModel)]="protocol"></nz-checkbox-group>
          </div>
        </div>
        <div nz-form-item nz-row>
          <div nz-form-label nz-col [nzSpan]="2">
            <label>文件还原长度</label>
          </div>
          <div nz-form-control nz-col [nzSpan]="22">
            <nz-input style="width: 220px;" name="limiation" [nzSize]="'default'" [(ngModel)]="limiation" [nzPlaceHolder]="'请输入'" ></nz-input>
            <nz-tooltip [nzTitle]="'单位为K，配置范围1-5000，默认5'" [nzPlacement]="'right'" [nzTrigger]="'hover'">
              <button nz-button nz-tooltip [nzType]="'primary'" [nzSize]="'default'" [nzShape]="'circle'">
                <i class="anticon anticon-question"></i>
              </button>
            </nz-tooltip>
          </div>
        </div>
        <div nz-form-item nz-row [nzType]="'flex'" [nzAlign]="'middle'">
          <div nz-form-label nz-col [nzSpan]="2">
            <label>文件类型</label>
          </div>
          <div nz-form-control nz-col [nzSpan]="13" class="nz_form_control_nz_col">
            <div nz-row>
              <div nz-col [nzSpan]="3" class="nz_col_label">
                <label>PE</label>
              </div>
              <div nz-col [nzSpan]="21">
                <nz-select  name="pe" [nzSize]="'default'" [(ngModel)]="pe" [nzMode]="'multiple'" [nzPlaceHolder]="'请选择'">
                  <nz-option
                    *ngFor="let option of options_pe"
                    [nzLabel]="option.label"
                    [nzValue]="option">
                  </nz-option>
                </nz-select>
              </div>
            </div>
            <div nz-row>
              <div nz-col [nzSpan]="3" class="nz_col_label">
                <label>压缩包</label>
              </div>
              <div nz-col [nzSpan]="21">
                <nz-select  name="zipfile" [nzSize]="'default'" [(ngModel)]="zipfile" [nzMode]="'multiple'" [nzPlaceHolder]="'请选择'">
                  <nz-option
                    *ngFor="let option of options_zipfile"
                    [nzLabel]="option.label"
                    [nzValue]="option">
                  </nz-option>
                </nz-select>
              </div>
            </div>
            <div nz-row>
              <div nz-col [nzSpan]="3" class="nz_col_label">
                <label>文档</label>
              </div>
              <div nz-col [nzSpan]="21">
                <nz-select  name="document" [nzSize]="'default'" [(ngModel)]="document" [nzMode]="'multiple'" [nzPlaceHolder]="'请选择'">
                  <nz-option
                    *ngFor="let option of options_document"
                    [nzLabel]="option.label"
                    [nzValue]="option">
                  </nz-option>
                </nz-select>
              </div>
            </div>
          </div>
        </div>
        <div nz-form-item nz-row [nzType]="'flex'" [nzAlign]="'middle'" class="ant-form-item-last">
          <div nz-form-label nz-col [nzSpan]="2">
            <label>联动分析网段</label>
          </div>
          <div nz-form-control nz-col [nzSpan]="13" class="nz_form_control_nz_col">
            <div nz-row>
              <div nz-col [nzSpan]="3" class="nz_col_label">
                <label>源地址</label>
              </div>
              <div nz-col [nzSpan]="21">
                <nz-select  name="sobj" [nzSize]="'default'" [(ngModel)]="sobj" [nzMode]="'multiple'" [nzPlaceHolder]="'请选择'">
                  <nz-option
                    *ngFor="let option of options_sobj"
                    [nzLabel]="option.label"
                    [nzValue]="option">
                  </nz-option>
                </nz-select>
              </div>
            </div>
            <div nz-row>
              <div nz-col [nzSpan]="3" class="nz_col_label">
                <label>目的地址</label>
              </div>
              <div nz-col [nzSpan]="21">
                <nz-select  name="dobj" [nzSize]="'default'" [(ngModel)]="dobj" [nzMode]="'multiple'" [nzPlaceHolder]="'请选择'">
                  <nz-option
                    *ngFor="let option of options_dobj"
                    [nzLabel]="option.label"
                    [nzValue]="option">
                  </nz-option>
                </nz-select>
              </div>
            </div>
            <div nz-row>
              <div nz-col [nzSpan]="24">
                <nz-alert [nzType]="'info'" [nzMessage]="'指定被检测的源、或者目的地址，any为所有，不能为空'" [nzShowIcon]="'true'"></nz-alert>
              </div>
            </div>
          </div>
        </div>
      </nz-collapse>
      <nz-collapse *ngIf="enabled" [nzTitle]="'告警阈值'" [nzActive]="true" [ngStyle]="{'border-radius': '4px','border': '0px'}">
        <div nz-row style="text-align: center;margin-bottom: 20px;">
          <div nz-col [nzSpan]="15" [nzOffset]="1">
            <h3>信誉值</h3>
          </div>
        </div>
        <div nz-row style="margin-bottom: 20px;">
          <div nz-col [nzSpan]="15" [nzOffset]="1">
            <nz-slider #nzSliderAtp nzRange name="rangeValueAtp" [(ngModel)]="rangeValueAtp" [nzMax]="5" [nzStep]="1" [nzMarks]="marks"></nz-slider>
          </div>
        </div>
        <div nz-row style="margin-bottom: 20px;">
          <div nz-col [nzSpan]="5" [nzOffset]="1" style="text-align: center;">
            <h3>允许</h3>
            <div>轻度威胁，允许访问</div>
            <div>不会记录日志</div>
          </div>
          <div nz-col [nzSpan]="5" style="text-align: center;">
            <h3>告警</h3>
            <div>中度威胁，允许访问</div>
            <div>并记录日志</div>
          </div>
          <div nz-col [nzSpan]="5" style="text-align: center;;">
            <h3>阻断</h3>
            <div>高度威胁，禁止访问</div>
            <div>并记录日志</div>
          </div>
        </div>
      </nz-collapse>
      <div nz-row style="padding: 0 16px;">
      </div>
    </nz-collapseset>
    <div class="submit-btn-row" nz-form-item nz-row [nzType]="'flex'" [nzJustify]="'center'">
      <div nz-col nz-form-control>
        <button nz-button [nzType]="'primary'">确认</button>
        <button nz-button (click)="cancle($event)">取消</button>
      </div>
    </div>
  </form>
</div>